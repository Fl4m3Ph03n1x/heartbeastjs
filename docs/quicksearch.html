<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"heartbeat.js.html":{"id":"heartbeat.js.html","title":"Source: heartbeat.js","body":" DocStrap Modules heartBeat Source: heartbeat.js &quot;use strict&quot;; const isFunction = require(&quot;lodash.isfunction&quot;); /** * @public * @author Pedro Miguel P. S. Martins * @version 1.0.1 * @module heartBeat * @desc Runs a given function periodically and watches for timeouts. */ const heartBeatFactory = () =&gt; { const DEFAULT = { TIMEOUT: 5000, INTERVAL: 3000 }; let interval = DEFAULT.INTERVAL, timeout = DEFAULT.TIMEOUT, ping, pong, timer, lastHeartbeatTime, timeoutTimer; const events = { timeout: () =&gt; {} }; /** * @public * @func hasTimedOut * @returns {Boolean} &lt;code&gt;true&lt;/code&gt; if the heartbeat has timedout, * &lt;code&gt;false&lt;/code&gt; otherwise. * * @description Used to detected if a heartbeat has timedout. A * heartbeat times out when it sends a ping, and receives * no pong after a given period of time. The timeout period * can be manipulated via &lt;code&gt;setBeatTimeout&lt;/code&gt;. * @see &lt;code&gt;setBeatTimeout&lt;/code&gt; */ const hasTimedOut = () =&gt; Date.now() - lastHeartbeatTime &gt; timeout; /** * @public * @func getBeatInterval * @returns {Number} The current heartbeat interval. * * @description Returns the current hearbeat interval. The heartbeat * interval is the interval at which the heartbeat will run * the &lt;code&gt;ping&lt;/code&gt; function. */ const getBeatInterval = () =&gt; interval; /** * @public * @func setBeatInterval * @param {Number} newInterval The new heartbeat interval. * @throws {TypeError} If &lt;code&gt;newInterval&lt;/code&gt; is not a Number. * * @description Sets the current heartbeat interval to the given one. * Note that setting the heartbeat interval will &lt;b&gt;not&lt;/b&gt; * affetct current heartbeat running. You must * &lt;code&gt;stop&lt;/code&gt; them and then &lt;code&gt;start&lt;/code&gt; them * for the new interval to be applied. * @see &lt;code&gt;stop&lt;/code&gt; * @see &lt;code&gt;start&lt;/code&gt; */ const setBeatInterval = newInterval =&gt; { if(isNaN(newInterval)) throw new TypeError(`${newInterval} must be a Number.`); interval = newInterval; }; /** * @public * @func getBeatTimeout * @returns {Number} The current timeout. * * @description Returns the current hearbeat timeout. The heartbeat * timeout is the amount of time that must pass for the * &lt;code&gt;hasTimedOut&lt;/code&gt; to return &lt;code&gt;true&lt;/code&gt;. * @see &lt;code&gt;hasTimedOut&lt;/code&gt; */ const getBeatTimeout = () =&gt; timeout; /** * @public * @func setBeatTimeout * @param {Number} newTimeout The new newTimeout. * @throws {TypeError} If &lt;code&gt;newTimeout&lt;/code&gt; is not a Number. * * @description Sets the current timeout to the given one. * Setting the timeout this way will immediatly affect the * &lt;code&gt;hasTimedOut&lt;/code&gt; method without the need to * restart the heartbeat object. Invoking this method * &lt;b&gt;does&lt;/b&gt; restart the timer controlling the * &lt;code&gt;onTimeout&lt;/code&gt; event. * @see &lt;code&gt;hasTimedOut&lt;/code&gt; * @see &lt;code&gt;onTimeout&lt;/code&gt; */ const setBeatTimeout = newTimeout =&gt; { if(isNaN(newTimeout)) throw new TypeError(`${newTimeout} must be a Number.`); timeout = newTimeout; clearTimeout(timeoutTimer); timeoutTimer = setTimeout(events.timeout, getBeatTimeout()); }; /** * @public * @func getPing * @returns {Object} The current object being used as a ping. * * @description Returns the ping object being used. */ const getPing = () =&gt; ping; /** * @public * @func setPing * @param {Object} newPing The new ping object. * * @description Sets the current ping object. A ping object can * be anything that the receiver accepts, from a Buffer of * bytes to plain Object to a primitive. */ const setPing = newPing =&gt; { ping = newPing; }; /** * @public * @func getPong * @returns {Object} The current object being used as a pong. * * @description Returns the pong object being used. */ const getPong = () =&gt; pong; /** * @public * @func setPong * @param {Object} newPong The new pong object. * * @description Sets the pong object we expect to receive from the * target of the heartbeats. This is only needed if there * is a need to distinguish between normal messages from * the target of heartbeat and pong messages that need to * be processed differently. */ const setPong = newPong =&gt; { pong = newPong; }; /** * @public * @func receivedPong * * @description Notifies the hearbeat that it has received a pong from * the target. */ const receivedPong = () =&gt; { lastHeartbeatTime = Date.now(); clearTimeout(timeoutTimer); timeoutTimer = setTimeout(events.timeout, getBeatTimeout()); }; /** * @public * @func stop * * @description Stops the heartbeat object and clears all internal * states. */ const stop = () =&gt; { lastHeartbeatTime = undefined; clearInterval(timer); timer = undefined; clearTimeout(timeoutTimer); timeoutTimer = undefined; }; /** * @public * @func start * @param {Function} fn The function that will be executed periodically * by the heartbeat object. * @throws {TypeError} If &lt;code&gt;fn&lt;/code&gt; is not a function. * * @description Starts the heartbeat object, executing the given * function &lt;code&gt;fn&lt;/code&gt; every interval. If you want to * send a ping to an object every interval, this is where * you defined that. */ const start = fn =&gt; { if (!isFunction(fn)) throw new TypeError(`${fn} must be a function.`); lastHeartbeatTime = Date.now(); timer = setInterval(fn, getBeatInterval()); timeoutTimer = setTimeout(events.timeout, getBeatTimeout()); }; /** * @public * @func onTimeout * @param {Function} fn The function to be executed when a timeout * occurs. * @throws {TypeError} If &lt;code&gt;fn&lt;/code&gt; is not a function. * * @description Runs the given function when the heartbeat detects a * timeout. A timeout is deteceted if * &lt;code&gt;receivedPong&lt;/code&gt; is not called within the * defined 'timeout' period. */ const onTimeout = fn =&gt; { if (!isFunction(fn)) throw new TypeError(`${fn} must be a function.`); events.timeout = fn; }; /** * @public * @func isBeating * @returns {Boolean} &lt;code&gt;true&lt;/code&gt; if the heartbeat is active, * &lt;code&gt;false&lt;/code&gt; otherwise. * * @description Returns &lt;code&gt;true&lt;/code&gt; if the heartbeat is active, * &lt;code&gt;false&lt;/code&gt; otherwise. A heartbeat is considered * active if it was started and has not beend stopped yet. */ const isBeating = () =&gt; timer !== undefined; /** * @public * @func reset * * @description Stops the heartbeat if it is beating, and resets all * properties to the original default values. */ const reset = () =&gt; { if (isBeating()) stop(); setBeatInterval(DEFAULT.INTERVAL); setBeatTimeout(DEFAULT.TIMEOUT); ping = undefined; pong = undefined; onTimeout(() =&gt; {}); }; return Object.freeze({ getBeatInterval, setBeatInterval, getBeatTimeout, setBeatTimeout, hasTimedOut, getPing, setPing, getPong, receivedPong, setPong, stop, start, reset, isBeating, onTimeout }); }; module.exports = heartBeatFactory; × Search results Close "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" DocStrap Modules heartBeat Modules × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" DocStrap Modules heartBeat Whatheartbeatjs is a small light weight library that helps you run periodicheartbeat functions and detects timeouts when they occur by launching events. It was mainly designed for tcp/ip connections, but you can use it with anyprotocol you want as it designed to be generic. WhyWhen you are connected to a third party mahcine (aka target), most of the timeyou need to know if the target is alive or not. To do this, there are two common scenarios: the target notifies you when it is about to go down you poll the target to check its status In cases where the first scenario doesn't happen or it is incomplete, you needto resort to polling to check on it. heartbeatjs was designed for this purpose and its function is to help you polltargets. HowFollowing are instructions on how to install and use heartbeatjs. For moreinformation about the project you can check the GitHub page: heartbeatjs Github And for questions you can ask in the issues page: heartbeatjs Issues For additional information on the API, feel free to check the heartbeatjs APImodule. Installnpm install heartbeatjs --saveExamplesStart a heartbeat that sends a message periodically to a target, withDEFAULT.TIMEOUT 5s and DEFAULT.INTERVAL 3s: const net = require('net'); const heartbeatFactory = require(&quot;heartbeatjs&quot;); const myHeartBeat = heartbeatFactory(); const client = net.createConnection({ port: 8124 }, () =&gt; { //'connect' listener console.log('connected to target!'); myHeartBeat.start(() =&gt; { client.write(&quot;Hello World!&quot;); }); });Now let's say that everytime we get a message, we consider it a pong: client.on(&quot;data&quot;, data =&gt; { myHeartBeat.receivedPong(); //timeout timer resetted! });Heartbeat with custom Pings and Pongs: const client = net.createConnection({ port: 8124 }, () =&gt; { //'connect' listener console.log('connected to target!'); myHeartBeat.setPing(&quot;Marco&quot;); myHeartBeat.setPong(&quot;Polo&quot;); myHeartBeat.start(() =&gt; { //send ping every 3s client.write(myHeartBeat.getPing()); }); }); client.on(&quot;data&quot;, data =&gt; { if(data === myHeartBeat.getPong()){ myHeartBeat.receivedPong(); return; } //process data });Listen to when target dies via timeout: const client = net.createConnection({ port: 8124 }, () =&gt; { //'connect' listener console.log('connected to target!'); myHeartBeat.onTimeout(() =&gt; console.log(&quot;Timed Out!&quot;)); myHeartBeat.start(() =&gt; { //send ping every 3s client.write(&quot;Hello World&quot;); }); }); × Search results Close "},"module-heartBeat.html":{"id":"module-heartBeat.html","title":"Module: heartBeat","body":" DocStrap Modules heartBeat Module: heartBeat Runs a given function periodically and watches for timeouts. Version: 1.0.1 Author: Pedro Miguel P. S. Martins Source: heartbeat.js, line 6 Methods &lt;inner&gt; getBeatInterval() Returns the current hearbeat interval. The heartbeat interval is the interval at which the heartbeat will run the ping function. Source: heartbeat.js, line 47 Returns: The current heartbeat interval. Type Number &lt;inner&gt; getBeatTimeout() Returns the current hearbeat timeout. The heartbeat timeout is the amount of time that must pass for the hasTimedOut to return true. Source: heartbeat.js, line 79 See: hasTimedOut Returns: The current timeout. Type Number &lt;inner&gt; getPing() Returns the ping object being used. Source: heartbeat.js, line 115 Returns: The current object being used as a ping. Type Object &lt;inner&gt; getPong() Returns the pong object being used. Source: heartbeat.js, line 137 Returns: The current object being used as a pong. Type Object &lt;inner&gt; hasTimedOut() Used to detected if a heartbeat has timedout. A heartbeat times out when it sends a ping, and receives no pong after a given period of time. The timeout period can be manipulated via setBeatTimeout. Source: heartbeat.js, line 32 See: setBeatTimeout Returns: true if the heartbeat has timedout, false otherwise. Type Boolean &lt;inner&gt; isBeating() Returns true if the heartbeat is active, false otherwise. A heartbeat is considered active if it was started and has not beend stopped yet. Source: heartbeat.js, line 229 Returns: true if the heartbeat is active, false otherwise. Type Boolean &lt;inner&gt; onTimeout(fn) Runs the given function when the heartbeat detects a timeout. A timeout is deteceted if receivedPong is not called within the defined 'timeout' period. Parameters: Name Type Description fn function The function to be executed when a timeout occurs. Source: heartbeat.js, line 210 Throws: If fn is not a function. Type TypeError &lt;inner&gt; receivedPong() Notifies the hearbeat that it has received a pong from the target. Source: heartbeat.js, line 161 &lt;inner&gt; reset() Stops the heartbeat if it is beating, and resets all properties to the original default values. Source: heartbeat.js, line 241 &lt;inner&gt; setBeatInterval(newInterval) Sets the current heartbeat interval to the given one. Note that setting the heartbeat interval will not affetct current heartbeat running. You must stop them and then start them for the new interval to be applied. Parameters: Name Type Description newInterval Number The new heartbeat interval. Source: heartbeat.js, line 58 See: stop start Throws: If newInterval is not a Number. Type TypeError &lt;inner&gt; setBeatTimeout(newTimeout) Sets the current timeout to the given one. Setting the timeout this way will immediatly affect the hasTimedOut method without the need to restart the heartbeat object. Invoking this method does restart the timer controlling the onTimeout event. Parameters: Name Type Description newTimeout Number The new newTimeout. Source: heartbeat.js, line 91 See: hasTimedOut onTimeout Throws: If newTimeout is not a Number. Type TypeError &lt;inner&gt; setPing(newPing) Sets the current ping object. A ping object can be anything that the receiver accepts, from a Buffer of bytes to plain Object to a primitive. Parameters: Name Type Description newPing Object The new ping object. Source: heartbeat.js, line 124 &lt;inner&gt; setPong(newPong) Sets the pong object we expect to receive from the target of the heartbeats. This is only needed if there is a need to distinguish between normal messages from the target of heartbeat and pong messages that need to be processed differently. Parameters: Name Type Description newPong Object The new pong object. Source: heartbeat.js, line 146 &lt;inner&gt; start(fn) Starts the heartbeat object, executing the given function fn every interval. If you want to send a ping to an object every interval, this is where you defined that. Parameters: Name Type Description fn function The function that will be executed periodically by the heartbeat object. Source: heartbeat.js, line 189 Throws: If fn is not a function. Type TypeError &lt;inner&gt; stop() Stops the heartbeat object and clears all internal states. Source: heartbeat.js, line 174 × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
